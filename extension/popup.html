<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>CP Coach</title>
  <link rel="stylesheet" href="popup.css">
</head>

<body>
  <div class="container">
    <!-- Header -->
    <header class="header">
      <button id="change-mode" class="change-mode-btn hidden" title="Change Mode">‚öô</button>
      <h1>CP Coach</h1>
      <div id="daily-counter" class="daily-badge">Daily: --</div>
    </header>

    <!-- Mode Selection Screen -->
    <section id="mode-selection" class="mode-section">
      <h2>Choose Your Mode</h2>
      <div class="mode-buttons">
        <button id="mode-doing" class="mode-btn mode-doing">
          <span class="mode-icon">üéØ</span>
          <span class="mode-title">Doing</span>
          <span class="mode-desc">Auto-detect problem from CF link</span>
        </button>
        <button id="mode-random" class="mode-btn mode-random">
          <span class="mode-icon">üé≤</span>
          <span class="mode-title">Random Solve</span>
          <span class="mode-desc">Practice random problems</span>
        </button>
      </div>
    </section>


    <!-- Input Section -->
    <section class="input-section">
      <div class="field">
        <label for="handle">Handle</label>
        <input type="text" id="handle" placeholder="Codeforces handle">
        <span id="handle-status" class="status"></span>
      </div>

      <div class="field">
        <label for="topic">Topic</label>
        <select id="topic">
          <option value="implementation">Implementation (1865)</option>
          <option value="math">Math (1536)</option>
          <option value="greedy">Greedy (1452)</option>
          <option value="dp">Dynamic Programming (1256)</option>
          <option value="data structures">Data Structures (969)</option>
          <option value="brute force">Brute Force (930)</option>
          <option value="constructive algorithms">Constructive Algorithms (849)</option>
          <option value="graphs">Graphs (663)</option>
          <option value="sortings">Sortings (598)</option>
          <option value="binary search">Binary Search (577)</option>
          <option value="dfs and similar">DFS and Similar (564)</option>
          <option value="trees">Trees (482)</option>
          <option value="strings">Strings (458)</option>
          <option value="number theory">Number Theory (409)</option>
          <option value="combinatorics">Combinatorics (340)</option>
          <option value="geometry">Geometry (276)</option>
          <option value="bitmasks">Bitmasks (270)</option>
          <option value="two pointers">Two Pointers (268)</option>
          <option value="dsu">DSU (204)</option>
          <option value="shortest paths">Shortest Paths (159)</option>
          <option value="probabilities">Probabilities (152)</option>
          <option value="divide and conquer">Divide and Conquer (151)</option>
          <option value="hashing">Hashing (123)</option>
          <option value="games">Games (115)</option>
          <option value="flows">Flows (88)</option>
          <option value="interactive">Interactive (87)</option>
          <option value="matrices">Matrices (83)</option>
          <option value="string suffix structures">String Suffix Structures (65)</option>
          <option value="fft">FFT (46)</option>
          <option value="graph matchings">Graph Matchings (45)</option>
          <option value="ternary search">Ternary Search (36)</option>
          <option value="expression parsing">Expression Parsing (33)</option>
          <option value="meet-in-the-middle">Meet-in-the-Middle (32)</option>
          <option value="2-sat">2-SAT (17)</option>
          <option value="chinese remainder theorem">Chinese Remainder Theorem (10)</option>
          <option value="schedules">Schedules (5)</option>
        </select>
      </div>

      <button id="next-problem" class="btn-primary">FIND PROBLEM</button>
      <button id="view-analysis" class="btn-secondary">View Weakness Analysis</button>
    </section>

    <!-- Analysis Section -->
    <section id="analysis-view" class="analysis-section hidden">
      <h2>Weakness Analysis</h2>
      <div id="analysis-loading" class="loading hidden">Analyzing contest history...</div>
      <div id="analysis-content" class="hidden">
        <div class="ai-box">
          <h3>Coach's Insight</h3>
          <p id="ai-explanation"></p>
        </div>

        <h3>Weak Rating Bands</h3>
        <ul id="weak-bands-list" class="tag-list"></ul>

        <h3>Weak Topics</h3>
        <ul id="weak-topics-list" class="tag-list"></ul>

        <div style="display:flex; justify-content:space-between; align-items:center;">
          <h3>Upsolve Suggestions</h3>
          <button id="refresh-upsolve" class="btn-icon" title="Refresh Suggestions">‚Üª</button>
        </div>
        <div id="upsolve-list" class="upsolve-list"></div>
      </div>
      <button id="back-to-home" class="btn-secondary">Back to Practice</button>
    </section>

    <!-- Result Section -->
    <section id="result" class="result-section hidden">
      <hr>

      <div id="loading" class="loading hidden">
        Fetching...
      </div>

      <div id="error" class="error hidden"></div>

      <div id="problem" class="problem hidden">
        <div class="problem-header">
          <h2 id="problem-name" class="problem-name"></h2>
          <div class="rating-adjust-btns">
            <button id="rating-lower" class="btn-rating-adjust" title="Lower difficulty">‚ñº</button>
            <button id="rating-higher" class="btn-rating-adjust" title="Higher difficulty">‚ñ≤</button>
          </div>
        </div>
        <p class="problem-rating">Rating: <span id="problem-rating"></span> <span id="complexity-hint"
            class="complexity-hint"></span></p>
        <p class="problem-explanation" id="problem-explanation"></p>

        <!-- Hint Panel -->
        <div id="hint-panel" class="hint-panel hidden">
          <div class="hint-header">
            <span>üí° Hints</span>
            <button id="close-hints" class="btn-icon" title="Close">√ó</button>
          </div>
          <div class="hints-container">
            <div class="hint-item" id="hint-1">
              <div class="hint-label">Pattern</div>
              <div class="hint-content locked" id="hint-1-content">
                <span class="hint-locked">üîí Click to reveal</span>
              </div>
            </div>
            <div class="hint-item" id="hint-2">
              <div class="hint-label">Observation</div>
              <div class="hint-content locked" id="hint-2-content">
                <span class="hint-locked">üîí Click to reveal</span>
              </div>
            </div>
            <div class="hint-item" id="hint-3">
              <div class="hint-label">Approach</div>
              <div class="hint-content locked" id="hint-3-content">
                <span class="hint-locked">üîí Click to reveal</span>
              </div>
            </div>
            <div class="hint-item" id="hint-4">
              <div class="hint-label">Watch Out</div>
              <div class="hint-content locked" id="hint-4-content">
                <span class="hint-locked">üîí Click to reveal</span>
              </div>
            </div>
          </div>
        </div>

        <div class="timer-section">
          <div id="timer-display" class="timer-display">00:00</div>
          <button id="timer-toggle" class="btn-secondary timer-btn">Start Timer</button>
          <button id="timer-pause" class="btn-secondary timer-btn hidden">Pause</button>
        </div>

        <div class="action-buttons">
          <a id="solve-link" href="#" target="_blank" class="btn-solve">
            Solve
          </a>
          <button id="get-hint" class="btn-hint" title="Get progressive hints">
            üí° Hint
          </button>
          <button id="skip-btn" class="btn-skip">
            Skip
          </button>
          <button id="mark-solved" class="btn-mark">
            Mark as Solved
          </button>
        </div>

        <div id="solved-status" class="solved-status hidden"></div>
      </div>
    </section>

    <!-- Skill Radar Section -->
    <section id="skill-section" class="skill-section hidden">
      <h2>Your Skills</h2>
      <div class="skill-chart-container">
        <canvas id="skill-radar" width="250" height="250"></canvas>
      </div>
      <div id="skill-stats" class="skill-stats">
        <div class="stat-item">
          <span class="stat-label">Total Solved:</span>
          <span id="total-solved" class="stat-value">--</span>
        </div>
        <div class="stat-item">
          <span class="stat-label">Avg Skill Level:</span>
          <span id="avg-level" class="stat-value">--</span>
        </div>
      </div>
      <div id="skill-list" class="skill-list"></div>
      <button id="close-skills" class="btn-secondary" style="width:100%; margin-top: 10px;">Back to Practice</button>
    </section>

    <!-- Onboarding Wizard -->
    <section id="onboarding" class="onboarding-section hidden">
      <div class="onboarding-step" id="onboard-step-1">
        <h2>üëã Welcome to CP Coach!</h2>
        <p>Let's set you up for effective practice.</p>
        <div class="onboard-question">
          <label>What's your current Codeforces rating?</label>
          <div class="rating-options">
            <button class="rating-option" data-rating="800">
              < 800</button>
                <button class="rating-option" data-rating="1000">800-1200</button>
                <button class="rating-option" data-rating="1400">1200-1600</button>
                <button class="rating-option" data-rating="1800">1600+</button>
          </div>
        </div>
      </div>

      <div class="onboarding-step hidden" id="onboard-step-2">
        <h2>üéØ What challenges you most?</h2>
        <div class="topic-options">
          <button class="topic-option" data-topic="dp">Dynamic Programming</button>
          <button class="topic-option" data-topic="graphs">Graphs</button>
          <button class="topic-option" data-topic="greedy">Greedy</button>
          <button class="topic-option" data-topic="math">Math</button>
          <button class="topic-option" data-topic="binary search">Binary Search</button>
          <button class="topic-option" data-topic="implementation">Implementation</button>
        </div>
        <p class="onboard-hint">Select topics you want to improve</p>
      </div>

      <div class="onboarding-step hidden" id="onboard-step-3">
        <h2>‚è±Ô∏è Daily practice goal?</h2>
        <div class="goal-options">
          <button class="goal-option" data-goal="1">1 problem</button>
          <button class="goal-option" data-goal="3">3 problems</button>
          <button class="goal-option" data-goal="5">5 problems</button>
        </div>
      </div>

      <div class="onboarding-step hidden" id="onboard-step-4">
        <h2>üöÄ You're all set!</h2>
        <p>CP Coach will now recommend problems at your level and help you improve where you need it most.</p>
        <button id="start-practicing" class="btn-primary" style="width:100%;">Start Practicing</button>
      </div>

      <div class="onboard-progress">
        <span class="progress-dot active" data-step="1"></span>
        <span class="progress-dot" data-step="2"></span>
        <span class="progress-dot" data-step="3"></span>
        <span class="progress-dot" data-step="4"></span>
      </div>
    </section>
  </div>

  <script src="popup.js"></script>
</body>

</html>